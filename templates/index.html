<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SU Movie Recommender - Discover Your Next Favorite Movie</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #050505; color: #ffffff; margin: 0; padding: 0; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px 20px 60px; }
        .header { display: flex; align-items: center; justify-content: space-between; padding: 20px 0; }
        .logo { font-size: 32px; font-weight: 700; color: #E50914; letter-spacing: 0.5px; }
        .logo-icon { margin-right: 10px; font-size: 40px; }
        .header-left { display: flex; align-items: center; gap: 6px; }
        .header-tagline { font-size: 12px; color: #888888; text-transform: uppercase; letter-spacing: 1.2px; }
        .hero { text-align: center; padding: 80px 0 40px; }
        .hero h1 { font-size: 50px; font-weight: 700; margin-bottom: 10px; line-height: 1.2; }
        .hero .favorite-text { color: #E50914; }
        .hero p { font-size: 18px; color: #aaaaaa; margin-bottom: 30px; }

        .search-container { display: flex; justify-content: center; margin-top: 20px; }
        .search-container form { display: flex; width: 100%; max-width: 700px; background-color: #1b1b1b; border-radius: 999px; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7); border: 1px solid #2b2b2b; }
        .search-container input[type="text"] { flex-grow: 1; padding: 16px 24px; border: none; background-color: transparent; color: #ffffff; font-size: 16px; outline: none; }
        .search-container input[type="text"]::placeholder { color: #666666; }
        .search-container select { background-color: #262626; color: #ffffff; border: none; padding: 0 16px; font-size: 14px; border-left: 1px solid #333333; outline: none; }
        .search-container button { background: linear-gradient(90deg, #E50914, #ff4b2b); color: white; padding: 0 26px; border: none; cursor: pointer; font-size: 16px; font-weight: 600; transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease; }
        .search-container button:hover { transform: translateY(-1px); box-shadow: 0 8px 20px rgba(0,0,0,0.6); }

        .algo-pills { display: flex; justify-content: center; gap: 10px; margin-top: 18px; flex-wrap: wrap; }
        .algo-pill { font-size: 13px; padding: 8px 16px; border-radius: 999px; border: 1px solid #333333; background-color: #151515; color: #cccccc; cursor: pointer; transition: all 0.2s ease; font-weight: 500; }
        .algo-pill:hover { background-color: #222222; border-color: #444444; transform: translateY(-1px); }
        .algo-pill.active { background: linear-gradient(135deg, #E50914, #ff4b2b); border-color: #E50914; color: #ffffff; box-shadow: 0 4px 12px rgba(229, 9, 20, 0.4); }

        .algo-description { max-width: 700px; margin: 16px auto 0; font-size: 13px; color: #b3b3b3; text-align: center; }

        .movie-section { padding: 40px 0; }
        .movie-section h2 { font-size: 26px; font-weight: 600; margin-bottom: 12px; display: flex; align-items: baseline; justify-content: space-between; gap: 10px; flex-wrap: wrap; }
        .section-subtitle { font-size: 13px; color: #888888; font-weight: 400; font-style: italic; }
        .section-header-wrapper { display: flex; flex-direction: column; gap: 8px; }
        .section-badge { display: inline-block; background: linear-gradient(135deg, #E50914, #ff4b2b); color: white; font-size: 11px; padding: 4px 10px; border-radius: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .info-box { background: linear-gradient(135deg, rgba(229, 9, 20, 0.1), rgba(255, 75, 43, 0.05)); border-left: 3px solid #E50914; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; color: #cccccc; }
        .info-box strong { color: #E50914; }

        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 24px; list-style: none; padding: 0; margin-top: 20px; }
        .movie-card { background: radial-gradient(circle at top, #262626, #111111); border-radius: 16px; overflow: hidden; box-shadow: 0 6px 18px rgba(0, 0, 0, 0.7); text-align: left; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative; border: 1px solid rgba(255, 255, 255, 0.05); }
        .movie-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 20px 50px rgba(229, 9, 20, 0.3), 0 0 0 1px rgba(229, 9, 20, 0.2); border-color: rgba(229, 9, 20, 0.3); }
        .movie-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, #E50914, #ff4b2b); opacity: 0; transition: opacity 0.3s; }
        .movie-card:hover::before { opacity: 1; }

        .movie-card img { width: 100%; height: 270px; object-fit: cover; display: block; transition: transform 0.3s; }
        .movie-card:hover img { transform: scale(1.05); }
        .movie-card-fallback { width: 100%; height: 270px; background: linear-gradient(135deg, #2a2a2a, #1a1a1a); display: flex; justify-content: center; align-items: center; flex-direction: column; padding: 10px; box-sizing: border-box; }
        .movie-card-fallback .icon { font-size: 48px; margin-bottom: 10px; opacity: 0.6; }
        .movie-card-fallback p { font-size: 13px; margin: 0; color: #888888; }

        .movie-card-title { padding: 14px 16px 16px; font-size: 15px; font-weight: 500; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; min-height: 48px; line-height: 1.4; color: #ffffff; }

        .error-message { background: linear-gradient(135deg, rgba(59, 17, 17, 0.9), rgba(40, 10, 10, 0.9)); color: #ffb3b3; padding: 16px 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #E50914; text-align: left; max-width: 700px; margin-left: auto; margin-right: auto; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5); }

        .footer { margin-top: 60px; padding-top: 24px; border-top: 1px solid #1f1f1f; font-size: 12px; color: #777777; display: flex; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
        .footer span { opacity: 0.85; }
        
        /* Smooth scroll behavior */
        html { scroll-behavior: smooth; }
        
        /* Loading state for cards */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .movie-card { animation: fadeInUp 0.4s ease-out; }
        .movie-card:nth-child(1) { animation-delay: 0.05s; }
        .movie-card:nth-child(2) { animation-delay: 0.1s; }
        .movie-card:nth-child(3) { animation-delay: 0.15s; }
        .movie-card:nth-child(4) { animation-delay: 0.2s; }
        .movie-card:nth-child(5) { animation-delay: 0.25s; }
        .movie-card:nth-child(6) { animation-delay: 0.3s; }

        .activate-windows { position: fixed; bottom: 20px; right: 20px; background-color: rgba(0, 0, 0, 0.8); color: #ffffff; padding: 10px; border-radius: 5px; font-size: 12px; opacity: 0.8; }

        @media (max-width: 768px) {
            .hero { padding-top: 40px; }
            .hero h1 { font-size: 34px; }
            .search-container form { border-radius: 16px; flex-direction: column; align-items: stretch; }
            .search-container input[type="text"] { padding: 14px 14px; }
            .search-container select, .search-container button { width: 100%; padding: 10px 14px; border-left: none; border-top: 1px solid #333333; }
            .search-container button { border-radius: 0 0 16px 16px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <span class="logo-icon">üé¨</span>
                <span class="logo">SU Movie Recommender</span>
            </div>
            <div class="header-tagline">Intelligent Movie Discovery</div>
        </div>

        <div class="hero">
            <h1>Discover Your Next <span class="favorite-text">Favorite Movie</span></h1>
            <p>Get AI-powered recommendations using multiple similarity strategies and popularity signals.</p>

            {% if error %}
                <div class="error-message">
                    <strong>Error:</strong> {{ error }}
                </div>
            {% endif %}

            <div class="search-container">
                <form action="/recommend" method="POST">
                    <input type="text" name="movie" list="movie-titles" placeholder="Enter a movie you love..." required>
                    <datalist id="movie-titles">
                        {% for movie in movies %}
                            <option value="{{ movie }}">
                        {% endfor %}
                    </datalist>

                    <!-- Recommendation method selector -->
                    <select id="method-select" name="method">
                        <option value="content_cosine" {% if selected_method == 'content_cosine' or not selected_method %}selected{% endif %}>
                            Content-based (Cosine)
                        </option>
                        <option value="collaborative_like" {% if selected_method == 'collaborative_like' %}selected{% endif %}>
                            Collaborative-style (Dot Product)
                        </option>
                        <option value="content_euclidean" {% if selected_method == 'content_euclidean' %}selected{% endif %}>
                            Content-based (Euclidean)
                        </option>
                        <option value="content_manhattan" {% if selected_method == 'content_manhattan' %}selected{% endif %}>
                            Content-based (Manhattan)
                        </option>
                        <option value="popularity" {% if selected_method == 'popularity' %}selected{% endif %}>
                            Popularity Based
                        </option>
                    </select>

                    <button type="submit">Get Recommendations</button>
                </form>
            </div>

            <div class="algo-pills">
                <button type="button" class="algo-pill" data-method="content_cosine">Cosine</button>
                <button type="button" class="algo-pill" data-method="collaborative_like">Dot Product</button>
                <button type="button" class="algo-pill" data-method="content_euclidean">Euclidean</button>
                <button type="button" class="algo-pill" data-method="content_manhattan">Manhattan</button>
                <button type="button" class="algo-pill" data-method="popularity">Popularity</button>
            </div>

            <div class="algo-description" id="algo-description">
                <!-- Filled by JavaScript based on selected method -->
            </div>
        </div>

        {% if recommendations %}
            <div class="movie-section">
                <div class="section-header-wrapper">
                    <h2>
                        <span>Recommendations for '<span style="color: #E50914;">{{ movie }}</span>'</span>
                        <span class="section-badge">{{ recommendations | length }} Movies</span>
                    </h2>
                    {% if selected_method %}
                        <div class="section-subtitle">
                            Algorithm: 
                            {% if selected_method == 'content_cosine' %}
                                <strong>Content-based (Cosine Similarity)</strong>
                            {% elif selected_method == 'collaborative_like' %}
                                <strong>Collaborative-style (Dot Product on Tags)</strong>
                            {% elif selected_method == 'content_euclidean' %}
                                <strong>Content-based (Euclidean Distance)</strong>
                            {% elif selected_method == 'content_manhattan' %}
                                <strong>Content-based (Manhattan Distance)</strong>
                            {% elif selected_method == 'popularity' %}
                                <strong>Popularity Based</strong>
                            {% else %}
                                <strong>{{ selected_method }}</strong>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
                <ul class="movie-grid">
                    {% for rec_movie in recommendations %}
                        <li class="movie-card">
                            {% set poster_url = recommended_posters.get(rec_movie) %}
                            
                            {% if poster_url %}
                                <img src="{{ poster_url }}" alt="{{ rec_movie }} Poster" loading="lazy">
                            {% else %}
                                <div class="movie-card-fallback">
                                    <span class="icon">üéûÔ∏è</span>
                                    <p>Poster not found</p>
                                </div>
                            {% endif %}
                            
                            <p class="movie-card-title">{{ rec_movie }}</p>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
        
        <div class="movie-section">
            <div class="section-header-wrapper">
                <h2>
                    <span>Featured Movies</span>
                    <span class="section-badge">{{ display_movies | length }} of {{ movies | length }}</span>
                </h2>
                <div class="section-subtitle">A curated sample from our catalog of {{ movies | length }} movies</div>
            </div>
            <div class="info-box">
                <strong>üí° Tip:</strong> Use the search bar above to find recommendations for any movie from our full database of {{ movies | length }} titles!
            </div>
            <ul class="movie-grid">
                {% for movie in display_movies %} 
                    <li class="movie-card">
                        {% set poster_url = movie_posters.get(movie) %}

                        {% if poster_url %}
                            <img src="{{ poster_url }}" alt="{{ movie }} Poster" loading="lazy">
                        {% else %}
                            <div class="movie-card-fallback">
                                <span class="icon">üéûÔ∏è</span>
                                <p>Poster not found</p>
                            </div>
                        {% endif %}
                        
                        <p class="movie-card-title">{{ movie }}</p>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div class="footer">
            <span>¬© 2025 SU Movie Recommender. All rights reserved.</span>
            <span>Powered by content-based, collaborative-style and popularity-based recommendation algorithms.</span>
        </div>
    </div>

    <div class="activate-windows">
        Activate Windows<br>
        Go to Settings to activate Windows.
    </div>

    <script>
        (function () {
            const methodSelect = document.getElementById("method-select");
            const algoPills = document.querySelectorAll(".algo-pill");
            const descEl = document.getElementById("algo-description");

            if (!methodSelect || !descEl) return;

            const descriptions = {
                content_cosine: "Cosine: finds movies with similar genres, keywords, cast, and overview using cosine similarity on the tag vectors.",
                collaborative_like: "Dot product: highlights movies that strongly share many tags with your chosen title (collaborative-style on tag space).",
                content_euclidean: "Euclidean: uses straight-line distance between tag vectors; closer points are treated as more similar movies.",
                content_manhattan: "Manhattan: uses grid-distance between tag vectors, which can be more robust when many tags differ.",
                popularity: "Popularity: ignores your input movie and shows globally popular titles based on rating and vote counts (when available)."
            };

            function updateUIFromMethod(method) {
                // Update dropdown value
                methodSelect.value = method;

                // Update pills
                algoPills.forEach((pill) => {
                    if (pill.getAttribute("data-method") === method) {
                        pill.classList.add("active");
                    } else {
                        pill.classList.remove("active");
                    }
                });

                // Update description
                descEl.textContent = descriptions[method] || "";
            }

            // Initial state from server-side selected_method
            const initialMethod = "{{ selected_method or 'content_cosine' }}";
            updateUIFromMethod(initialMethod);

            // Sync on dropdown change
            methodSelect.addEventListener("change", (e) => {
                updateUIFromMethod(e.target.value);
            });

            // Sync when user clicks a pill
            algoPills.forEach((pill) => {
                pill.addEventListener("click", () => {
                    const method = pill.getAttribute("data-method");
                    updateUIFromMethod(method);
                });
            });
        })();
    </script>

</body>
</html>